"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5337,3368],{99980:(K,i,e)=>{e.d(i,{g:()=>g});var t=e(2784),r=e(90996),d=e(92980);function g(h){const{themeId:E,children:D,...P}=h;return t.createElement(d.T,{themeId:E},t.createElement(r.h,{...P}),D)}},92777:(K,i,e)=>{e.d(i,{d:()=>Ee});var t=e(8554),r=e(95544),d=e(21324),g=e(5806),h=e(86619),E=e(90436),D=e(80030),P=e(79692),p=e(15459),c=e(19996),U=e(25505),W=e(38016),B=e(97570),n=e(2784),z=e(62862),N=e(85166),V=e(2465);function C(a){const o=(0,V.x)(a);(0,n.useEffect)(()=>()=>{o.current()},[])}function L(a,o,s,m=0){const u=(0,n.useRef)(),l=(0,n.useRef)(),f=(0,n.useRef)(a),M=(0,n.useRef)(),A=()=>{u.current&&(clearTimeout(u.current),u.current=void 0),l.current&&(clearTimeout(l.current),l.current=void 0)};return C(A),(0,n.useEffect)(()=>{f.current=a},o),(0,n.useMemo)(()=>{const Z=()=>{if(A(),!M.current)return;const y=M.current;M.current=void 0,f.current.apply(y.this,y.args)},$=function(...y){u.current&&clearTimeout(u.current),M.current={args:y,this:this},u.current=setTimeout(Z,s),m>0&&!l.current&&(l.current=setTimeout(Z,m))};return Object.defineProperties($,{length:{value:a.length},name:{value:`${a.name||"anonymous"}__debounced__${s}`}}),$},[s,m,...o])}function T(a,o,s,m=0){(0,n.useEffect)(L(a,o,s,m),o)}var S=e(98685),j=e(62367),x=e(51847),F=e(59274),X=e(66088),O=e(23200);function I({enabled:a}){const o=(0,F.h_)(O.A),[s]=(0,n.useState)(async()=>{if(!a)return[];const m="relations.ownedBy";return o.getEntityFacets({facets:[m]}).then(u=>u.facets[m].map(l=>l.value).map(l=>{const{kind:f,name:M,namespace:A}=(0,t.of)(l);return{apiVersion:"backstage.io/v1beta1",kind:f,metadata:{name:M,namespace:A}}}).sort((l,f)=>(l.metadata.namespace||"").localeCompare(f.metadata.namespace||"","en-US")||l.metadata.name.localeCompare(f.metadata.name,"en-US")||l.kind.localeCompare(f.kind,"en-US"))).catch(()=>[])});return(0,X.Z)(async(m,u)=>{var y;const l=await s;if(!l)return{items:[]};const f=(y=u==null?void 0:u.limit)!=null?y:20,{text:M,start:A}=J(m),Z=l.filter(ne=>Y(M,ne)),$=A+f;return{items:Z.slice(0,$),...G({entities:Z,limit:$,payload:{text:M,start:$}})}},[s],{loading:!0,value:{items:[]}})}function J(a){return Q(a)&&a.cursor?JSON.parse(atob(a.cursor)):{text:a.text||"",start:0}}function Q(a){return!!a.cursor}function G({entities:a,limit:o,payload:s}){return a.length>o?{cursor:btoa(JSON.stringify(s))}:{}}function Y(a,o){var m;const s=a.trim();return o.kind.includes(s)||((m=o.metadata.namespace)==null?void 0:m.includes(s))||o.metadata.name.includes(s)}function H(){const a=(0,F.h_)(O.A);return(0,X.Z)(async(o,s)=>{var M;const m=o,u=o,l=(M=s==null?void 0:s.limit)!=null?M:20;if(u.cursor){const A=await a.queryEntities({cursor:u.cursor,limit:l});return{cursor:A.pageInfo.nextCursor,items:[...u.items,...A.items]}}const f=await a.queryEntities({fullTextFilter:{term:m.text||"",fields:["metadata.name","kind","spec.profile.displayname","metadata.title"]},filter:{kind:["User","Group"]},orderFields:[{field:"metadata.name",order:"asc"}],limit:l});return{cursor:f.pageInfo.nextCursor,items:f.items}},[],{loading:!0})}var b=e(49257);function k({mode:a,initialSelectedOwnersRefs:o}){const s=a==="owners-only",m=H(),u=I({enabled:s}),[l,f]=s?u:m;return[l,f,q({enabled:!s,initialSelectedOwnersRefs:o})]}function q({enabled:a,initialSelectedOwnersRefs:o}){const s=(0,n.useRef)({}),m=(0,F.h_)(O.A),[,u]=(0,X.Z)(async()=>{(await m.getEntitiesByRefs({entityRefs:o})).items.forEach(f=>{f&&(s.current[(0,t.eE)(f)]=f)})},[]);return(0,b.n)(()=>{a&&o.length>0&&u()}),{getEntity:l=>s.current[l],setEntity:l=>{s.current[(0,t.eE)(l)]=l}}}var oe=e(72579),te=e(9402),se=e(82394);const _=(0,P.Z)({root:{},label:{},input:{},fullWidth:{width:"100%"},boxLabel:{width:"100%",textOverflow:"ellipsis",overflow:"hidden"}},{name:"CatalogReactEntityOwnerPicker"}),ee=(0,p.Z)(a=>({label:{width:"100%"},root:{width:"90%"}}),{name:"FixedWidthFormControlLabel"})(g.Z),me=n.createElement(U.Z,{fontSize:"small"}),ue=n.createElement(c.Z,{fontSize:"small"});function de(a){const o=_(),s=a.entity.kind.toLocaleLowerCase("en-US")==="group",{primaryTitle:m}=(0,te.V)(a.entity);return n.createElement(r.Z,{className:o.fullWidth},n.createElement(ee,{className:o.fullWidth,control:n.createElement(d.Z,{icon:me,checkedIcon:ue,checked:a.isSelected}),onClick:u=>u.preventDefault(),label:n.createElement(D.ZP,{title:m},n.createElement(r.Z,{display:"flex",alignItems:"center"},s?n.createElement(j.Z,{fontSize:"small"}):n.createElement(S.Z,{fontSize:"small"}),"\xA0",n.createElement(r.Z,{className:o.boxLabel},n.createElement(E.Z,{noWrap:!0},m))))}))}const Ee=a=>{var re,ce,ie;const o=_(),{mode:s="owners-only"}=a||{},{updateFilters:m,filters:u,queryParameters:{owners:l}}=(0,z.wp)(),[f,M]=(0,n.useState)(""),A=(0,n.useMemo)(()=>[l].flat().filter(Boolean),[l]),[Z,$]=(0,n.useState)(A.length?A:(ce=(re=u.owners)==null?void 0:re.values)!=null?ce:[]),[{value:y,loading:ne},ae,le]=k({mode:s,initialSelectedOwnersRefs:Z});T(()=>ae({text:f}),[f,ae],250);const fe=(y==null?void 0:y.items)||[];return(0,n.useEffect)(()=>{if(A.length){const v=new N.rf(A);$(v.values)}},[A]),(0,n.useEffect)(()=>{m({owners:Z.length?new N.rf(Z):void 0})},[Z,m]),["user","group"].includes(((ie=u.kind)==null?void 0:ie.value.toLocaleLowerCase("en-US"))||"")?null:n.createElement(r.Z,{className:o.root,pb:1,pt:1},n.createElement(E.Z,{className:o.label,variant:"button",component:"label"},"Owner",n.createElement(B.ZP,{PopperComponent:v=>n.createElement("div",{...v},v.children),multiple:!0,disableCloseOnSelect:!0,loading:ne,options:fe,value:Z,getOptionSelected:(v,R)=>typeof R=="string"?(0,t.eE)(v)===R:v===R,getOptionLabel:v=>{const R=typeof v=="string"?le.getEntity(v)||(0,t.of)(v,{defaultKind:"group",defaultNamespace:"default"}):v;return(0,x.w)(R,(0,x.$)(R))},onChange:(v,R)=>{M(""),$(R.map(w=>{const ve=typeof w=="string"?w:(0,t.eE)(w);return typeof w!="string"&&le.setEntity(w),ve}))},filterOptions:v=>v,renderOption:(v,{selected:R})=>n.createElement(de,{entity:v,isSelected:R}),size:"small",popupIcon:n.createElement(W.Z,{"data-testid":"owner-picker-expand"}),renderInput:v=>n.createElement(h.Z,{...v,className:o.input,onChange:R=>{M(R.currentTarget.value)},variant:"outlined"}),ListboxProps:{onScroll:v=>{const R=v.currentTarget;Math.abs(R.scrollHeight-R.clientHeight-R.scrollTop)<1&&(y!=null&&y.cursor)&&ae({items:y.items,cursor:y.cursor})},"data-testid":"owner-picker-listbox"}})))}},55337:(K,i,e)=>{e.r(i),e.d(i,{EmbeddedDocsRouter:()=>V,Router:()=>N,isTechDocsAvailable:()=>z});var t=e(2784),r=e(73557),d=e(8554),g=e(47933),h=e(5821),E=e(21329);const D="backstage.io/techdocs-entity",P=({entity:C})=>{var T,S;let L=(0,d.iB)(C);if((T=C.metadata.annotations)!=null&&T[D])try{L=(0,d.of)((S=C.metadata.annotations)==null?void 0:S[D])}catch{}return t.createElement(g.I6,{entityRef:L},t.createElement(E.b,null),t.createElement(h.F,{withSearch:!1}))};var p=e(53368),c=e(68803),U=e(89173),W=e(3808);const B="backstage.io/techdocs-ref",n="backstage.io/techdocs-entity",z=C=>{var L,T,S,j;return!!((T=(L=C==null?void 0:C.metadata)==null?void 0:L.annotations)!=null&&T[B])||!!((j=(S=C==null?void 0:C.metadata)==null?void 0:S.annotations)!=null&&j[n])},N=()=>t.createElement(r.Z5,null,t.createElement(r.AW,{path:"/",element:t.createElement(p.TechDocsIndexPage,null)}),t.createElement(r.AW,{path:"/:namespace/:kind/:name/*",element:t.createElement(c.I,null)})),V=C=>{var x,F;const{children:L}=C,{entity:T}=(0,U.X2)(),S=(0,r.V$)([{path:"/*",element:t.createElement(P,{entity:T}),children:[{path:"*",element:L}]}]);return((x=T.metadata.annotations)==null?void 0:x[B])||((F=T.metadata.annotations)==null?void 0:F[n])?S:t.createElement(W.s,{annotation:[B]})}},26166:(K,i,e)=>{e.d(i,{D:()=>t});function t(r,d){return d.getOptionalBoolean("techdocs.legacyUseCaseSensitiveTripletPaths")?r:r.toLocaleLowerCase("en-US")}},98696:(K,i,e)=>{e.d(i,{H:()=>N});var t=e(2784),r=e(99949),d=e(51491),g=e(59274),h=e(58185),E=e(9277),D=e(14914),P=e(51847),p=e(12864),c=e(26535),U=e(15698),W=e(55990),B=e(94935),n=e(92366),z=e(26166);const N=V=>{const{entities:C,title:L,loading:T,columns:S,actions:j,options:x}=V,[,F]=(0,r.Z)(),X=(0,d.t)(p.Fw),O=(0,g.h_)(h.D);if(!C)return null;const I=C.map(H=>{var k;const b=(0,D.h)(H,E.S4);return{entity:H,resolved:{docsUrl:X({namespace:(0,z.D)((k=H.metadata.namespace)!=null?k:"default",O),kind:(0,z.D)(H.kind,O),name:(0,z.D)(H.metadata.name,O)}),ownedByRelations:b,ownedByRelationsTitle:b.map(q=>(0,P.$)(q,{defaultKind:"group"})).join(", ")}}}),J=[n.N.createNameColumn(),n.N.createOwnerColumn(),n.N.createKindColumn(),n.N.createTypeColumn()],Q=[B.n.createCopyDocsUrlAction(F)],G=20,Y=I&&I.length>G;return t.createElement(t.Fragment,null,T||I&&I.length>0?t.createElement(c.i,{isLoading:T,options:{paging:Y,pageSize:G,search:!0,actionsColumnIndex:-1,...x},data:I,columns:S||J,actions:j||Q,title:L?`${L} (${I.length})`:`All (${I.length})`}):t.createElement(U.u,{missing:"data",title:"No documents to show",description:"Create your own document. Check out our Getting Started Information",action:t.createElement(W.Q,{color:"primary",to:"https://backstage.io/docs/features/techdocs/getting-started",variant:"contained"},"DOCS")}))};N.columns=n.N,N.actions=B.n},94935:(K,i,e)=>{e.d(i,{n:()=>D});var t=e(2784),r=e(39981),d=e(15459),g=e(11640),h=e(28347);const E=(0,d.Z)({root:{color:"#f3ba37"}})(g.Z),D={createCopyDocsUrlAction(P){return p=>({icon:()=>t.createElement(r.Z,{fontSize:"small"}),tooltip:"Click to copy documentation link to clipboard",onClick:()=>P(`${window.location.origin}${p.resolved.docsUrl}`)})},createStarEntityAction(P,p){return c=>{const U=c.entity,W=P(U);return{cellStyle:{paddingLeft:"1em"},icon:()=>W?t.createElement(E,null):t.createElement(h.Z,null),tooltip:W?"Remove from favorites":"Add to favorites",onClick:()=>p(U)}}}}},92366:(K,i,e)=>{e.d(i,{N:()=>p});var t=e(2784),r=e(95544),d=e(79692);const g=(0,d.Z)(c=>({value:{marginBottom:c.spacing(.75)},subvalue:{color:c.palette.textSubtle,fontWeight:"normal"}}),{name:"BackstageSubvalueCell"});function h(c){const{value:U,subvalue:W}=c,B=g();return t.createElement(t.Fragment,null,t.createElement(r.Z,{className:B.value},U),t.createElement(r.Z,{className:B.subvalue},W))}var E=e(87603),D=e(19631);function P(c){return c.metadata.title||c.metadata.name}const p={createNameColumn(){return{title:"Document",field:"entity.metadata.name",highlight:!0,render:c=>t.createElement(h,{value:t.createElement(E.rU,{to:c.resolved.docsUrl},P(c.entity)),subvalue:c.entity.metadata.description})}},createOwnerColumn(){return{title:"Owner",field:"resolved.ownedByRelationsTitle",render:({resolved:c})=>t.createElement(D.r,{entityRefs:c.ownedByRelations,defaultKind:"group"})}},createKindColumn(){return{title:"Kind",field:"entity.kind"}},createTypeColumn(){return{title:"Type",field:"entity.spec.type"}}}},53368:(K,i,e)=>{e.r(i),e.d(i,{TechDocsIndexPage:()=>X});var t=e(2784),r=e(73557),d=e(35182),g=e(70289),h=e(63003),E=e(62862),D=e(53818),P=e(17740),p=e(92777),c=e(82154),U=e(11091),W=e(73359);class B{getCatalogFilters(){return{"metadata.annotations.backstage.io/techdocs-ref":W.n}}}const n=()=>{const{updateFilters:O}=(0,E.wp)();return(0,t.useEffect)(()=>{O({techdocs:new B})},[O]),null};var z=e(99949),N=e(76635),V=e(92600),C=e(67977),L=e(74595),T=e(98696),S=e(94935),j=e(92366);const x=O=>{var _,ee;const{columns:I,actions:J,options:Q}=O,{loading:G,error:Y,entities:H,filters:b}=(0,E.wp)(),{isStarredEntity:k,toggleStarredEntity:q}=(0,L.C)(),[,oe]=(0,z.Z)(),te=(0,N.capitalize)((ee=(_=b.user)==null?void 0:_.value)!=null?ee:"all"),se=[S.n.createCopyDocsUrlAction(oe),S.n.createStarEntityAction(k,q)];return Y?t.createElement(V.G,{severity:"error",title:"Could not load available documentation."},t.createElement(C.O,{language:"text",text:Y.toString()})):t.createElement(T.H,{title:te,entities:H,loading:G,actions:J||se,columns:I,options:Q})};x.columns=j.N,x.actions=S.n;const F=O=>{const{initialFilter:I="owned",columns:J,actions:Q,ownerPickerMode:G}=O;return t.createElement(U.j,null,t.createElement(d.V,null,t.createElement(g.y,{title:""},t.createElement(h.q,null,"Discover documentation in your ecosystem.")),t.createElement(E.UO,null,t.createElement(D._i,null,t.createElement(D._i.Filters,null,t.createElement(n,null),t.createElement(P.E,{initialFilter:I}),t.createElement(p.d,{mode:G}),t.createElement(c.x,null)),t.createElement(D._i.Content,null,t.createElement(x,{actions:Q,columns:J}))))))},X=O=>(0,r.pC)()||t.createElement(F,{...O})},11091:(K,i,e)=>{e.d(i,{j:()=>h});var t=e(2784),r=e(99980),d=e(59274),g=e(58185);const h=E=>{var c;const{children:D}=E,p=`Documentation available in ${(c=(0,d.h_)(g.D).getOptionalString("organization.name"))!=null?c:"Backstage"}`;return t.createElement(r.g,{title:"Documentation",subtitle:p,themeId:"documentation"},D)}},62367:(K,i,e)=>{var t,r=e(71600),d=e(34590);t={value:!0},i.Z=void 0;var g=d(e(2784)),h=r(e(50175)),E=(0,h.default)(g.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group");i.Z=E},39981:(K,i,e)=>{var t,r=e(71600),d=e(34590);t={value:!0},i.Z=void 0;var g=d(e(2784)),h=r(e(50175)),E=(0,h.default)(g.createElement("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"}),"Share");i.Z=E}}]);})();

//# sourceMappingURL=5337.59be25b2.chunk.js.map